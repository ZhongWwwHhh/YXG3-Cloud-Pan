var promiseScript,fetchScript;window.MSInputMethodContext&&document.documentMode&&((promiseScript=document.createElement("script")).type="text/javascript",promiseScript.src="https://cdn.jsdelivr.net/npm/promise-polyfill@8.1.3/dist/polyfill.min.js",(fetchScript=document.createElement("script")).type="text/javascript",fetchScript.src="https://cdn.jsdelivr.net/npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js",document.head.appendChild(promiseScript),document.head.appendChild(fetchScript));const html=document.querySelector("html");let currdate=new Date,lightname=(6<=currdate.getHours()&&currdate.getHours()<18?html.classList.add("day"):html.classList.add("night"),void 0!==sessionStorage.lightname&&void 0!==sessionStorage.filepath&&void 0!==sessionStorage.write||(window.location.pathname="/login/"),null!=sessionStorage.lightname&&null!=sessionStorage.filepath&&null!=sessionStorage.write||(window.location.pathname="/login/"),sessionStorage.lightname),filepath=sessionStorage.filepath,write=sessionStorage.write,htmlLoading=document.querySelector("#loading");function loadingOn(){htmlLoading.classList.remove("loadingShow"),htmlLoading.classList.remove("loadingHide"),htmlLoading.classList.add("loadingShow")}function loadingOff(){htmlLoading.classList.remove("loadingShow"),htmlLoading.classList.remove("loadingHide"),htmlLoading.classList.add("loadingHide")}function downloadFile(e){console.log("download:"+e),window.open("/api/file/download.php?filepath="+filepath+"&filename="+e)}let htmlFileList=document.querySelector("#filelist");function getFileList(){console.log("get file list"),loadingOn();var e="/api/file/list.php?filepath="+filepath;fetch(e,{method:"GET"}).then(function(e){e.ok?e.json().then(function(e){if("success"==e.success){for(i in delete e.success,list="",e)list='<p id="file'+i+'">'+e[i]+"</p>"+list;list+="<p>No more</p>",htmlFileList.innerHTML=list;var o=document.querySelectorAll("p");for(let t=0;t<o.length-1;t++){let e=o[t].innerHTML;o[t].onclick=function(){downloadFile(e)}}loadingOff()}else alert("Invalid login information"),window.location.pathname="/login/"}):(alert("Network problem or request too frequently"),loadingOff())})}let htmlBtnRefresh=document.querySelector("#refresh"),htmlBtnQuit=(htmlBtnRefresh.onclick=getFileList,document.querySelector("#quit")),htmlBtnUpload=(htmlBtnQuit.onclick=function(){loadingOn(),"true"==write||1==write?fetch("/api/account/quit.php",{method:"GET"}).then(function(e){e.ok?(sessionStorage.clear(),window.location.pathname="/login/"):(alert("Network problem or request too frequently"),loadingOff())}):(sessionStorage.clear(),window.location.pathname="/login/")},document.querySelector("#upload"));"true"==write||1==write?htmlBtnUpload.className="uploadShow":htmlBtnUpload.className="uploadHide",window.onload=function(){getFileList(),loadingOff()};